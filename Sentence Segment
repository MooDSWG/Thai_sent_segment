{"cells":[{"cell_type":"markdown","source":["## State Condition"],"metadata":{"id":"v3tlb4hJrFgb"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"zVvslsfMIrIh"},"outputs":[],"source":["task = \"sep\"\n","pretokenized = True \n","model_checkpoint = \"airesearch/wangchanberta-base-att-spm-uncased\"\n","batch_size = 16\n","num_epoch = 3\n","if(pretokenized):\n","    condition = f\"pretokenized_{task}_nospace\"\n","else:\n","    condition =  f\"auto_tokenized_{task}_\"\n","limit_n_tokens = 150\n","save=\"no\"\n","#save=(\"no\",\"epoch\", or \"step\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1353,"status":"ok","timestamp":1659618061182,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"id":"23TOba33L4qf","outputId":"45207688-f0b7-4baf-9601-7875796e3d9b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Thu Aug  4 13:01:00 2022       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 460.32.03    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla P100-PCIE...  Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   50C    P0    33W / 250W |      0MiB / 16280MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["gpu_info = !nvidia-smi\n","gpu_info = '\\n'.join(gpu_info)\n","if gpu_info.find('failed') >= 0:\n","  print('Not connected to a GPU')\n","else:\n","  print(gpu_info)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":150246,"status":"ok","timestamp":1659618211426,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"id":"IhGH9YN4vXDs","outputId":"79b6c206-f8e5-4659-8772-5b4967718101"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import  drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"SKA2FHhT8P7A"},"source":["## Set Environment"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":28330,"status":"ok","timestamp":1659618239753,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"outputId":"9e324e04-db28-4957-b7b3-c2e64e31a3ba","id":"O63wB-xA8P7A"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.4.0-py3-none-any.whl (365 kB)\n","\u001b[K     |████████████████████████████████| 365 kB 4.2 MB/s \n","\u001b[?25hCollecting transformers==4.9.2\n","  Downloading transformers-4.9.2-py3-none-any.whl (2.6 MB)\n","\u001b[K     |████████████████████████████████| 2.6 MB 51.7 MB/s \n","\u001b[?25hCollecting seqeval\n","  Downloading seqeval-1.2.2.tar.gz (43 kB)\n","\u001b[K     |████████████████████████████████| 43 kB 2.1 MB/s \n","\u001b[?25hRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers==4.9.2) (4.12.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers==4.9.2) (1.21.6)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers==4.9.2) (2.23.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers==4.9.2) (2022.6.2)\n","Collecting sacremoses\n","  Downloading sacremoses-0.0.53.tar.gz (880 kB)\n","\u001b[K     |████████████████████████████████| 880 kB 46.3 MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers==4.9.2) (4.64.0)\n","Collecting huggingface-hub==0.0.12\n","  Downloading huggingface_hub-0.0.12-py3-none-any.whl (37 kB)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers==4.9.2) (3.7.1)\n","Collecting pyyaml>=5.1\n","  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)\n","\u001b[K     |████████████████████████████████| 596 kB 50.0 MB/s \n","\u001b[?25hCollecting tokenizers<0.11,>=0.10.1\n","  Downloading tokenizers-0.10.3-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (3.3 MB)\n","\u001b[K     |████████████████████████████████| 3.3 MB 38.2 MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from transformers==4.9.2) (21.3)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from huggingface-hub==0.0.12->transformers==4.9.2) (4.1.1)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->transformers==4.9.2) (3.0.9)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.7/dist-packages (from datasets) (3.8.1)\n","Collecting xxhash\n","  Downloading xxhash-3.0.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[K     |████████████████████████████████| 212 kB 52.8 MB/s \n","\u001b[?25hCollecting fsspec[http]>=2021.11.1\n","  Downloading fsspec-2022.7.1-py3-none-any.whl (141 kB)\n","\u001b[K     |████████████████████████████████| 141 kB 53.7 MB/s \n","\u001b[?25hCollecting datasets\n","  Downloading datasets-2.3.2-py3-none-any.whl (362 kB)\n","\u001b[K     |████████████████████████████████| 362 kB 55.4 MB/s \n","\u001b[?25h  Downloading datasets-2.3.1-py3-none-any.whl (362 kB)\n","\u001b[K     |████████████████████████████████| 362 kB 53.7 MB/s \n","\u001b[?25h  Downloading datasets-2.3.0-py3-none-any.whl (361 kB)\n","\u001b[K     |████████████████████████████████| 361 kB 52.6 MB/s \n","\u001b[?25h  Downloading datasets-2.2.2-py3-none-any.whl (346 kB)\n","\u001b[K     |████████████████████████████████| 346 kB 41.3 MB/s \n","\u001b[?25hCollecting dill<0.3.5\n","  Downloading dill-0.3.4-py2.py3-none-any.whl (86 kB)\n","\u001b[K     |████████████████████████████████| 86 kB 5.2 MB/s \n","\u001b[?25hCollecting datasets\n","  Downloading datasets-2.2.1-py3-none-any.whl (342 kB)\n","\u001b[K     |████████████████████████████████| 342 kB 51.6 MB/s \n","\u001b[?25h  Downloading datasets-2.2.0-py3-none-any.whl (342 kB)\n","\u001b[K     |████████████████████████████████| 342 kB 43.0 MB/s \n","\u001b[?25h  Downloading datasets-2.1.0-py3-none-any.whl (325 kB)\n","\u001b[K     |████████████████████████████████| 325 kB 53.6 MB/s \n","\u001b[?25hRequirement already satisfied: pyarrow>=5.0.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (6.0.1)\n","  Downloading datasets-2.0.0-py3-none-any.whl (325 kB)\n","\u001b[K     |████████████████████████████████| 325 kB 53.9 MB/s \n","\u001b[?25h  Downloading datasets-1.18.4-py3-none-any.whl (312 kB)\n","\u001b[K     |████████████████████████████████| 312 kB 48.9 MB/s \n","\u001b[?25h  Downloading datasets-1.18.3-py3-none-any.whl (311 kB)\n","\u001b[K     |████████████████████████████████| 311 kB 53.6 MB/s \n","\u001b[?25h  Downloading datasets-1.18.2-py3-none-any.whl (312 kB)\n","\u001b[K     |████████████████████████████████| 312 kB 54.5 MB/s \n","\u001b[?25h  Downloading datasets-1.18.1-py3-none-any.whl (311 kB)\n","\u001b[K     |████████████████████████████████| 311 kB 55.1 MB/s \n","\u001b[?25h  Downloading datasets-1.18.0-py3-none-any.whl (311 kB)\n","\u001b[K     |████████████████████████████████| 311 kB 51.4 MB/s \n","\u001b[?25h  Downloading datasets-1.17.0-py3-none-any.whl (306 kB)\n","\u001b[K     |████████████████████████████████| 306 kB 47.0 MB/s \n","\u001b[?25h  Downloading datasets-1.16.1-py3-none-any.whl (298 kB)\n","\u001b[K     |████████████████████████████████| 298 kB 52.7 MB/s \n","\u001b[?25h  Downloading datasets-1.16.0-py3-none-any.whl (298 kB)\n","\u001b[K     |████████████████████████████████| 298 kB 54.8 MB/s \n","\u001b[?25h  Downloading datasets-1.15.1-py3-none-any.whl (290 kB)\n","\u001b[K     |████████████████████████████████| 290 kB 53.0 MB/s \n","\u001b[?25h  Downloading datasets-1.15.0-py3-none-any.whl (290 kB)\n","\u001b[K     |████████████████████████████████| 290 kB 52.9 MB/s \n","\u001b[?25hCollecting multiprocess\n","  Downloading multiprocess-0.70.13-py37-none-any.whl (115 kB)\n","\u001b[K     |████████████████████████████████| 115 kB 59.0 MB/s \n","\u001b[?25hCollecting datasets\n","  Downloading datasets-1.14.0-py3-none-any.whl (290 kB)\n","\u001b[K     |████████████████████████████████| 290 kB 54.3 MB/s \n","\u001b[?25h  Downloading datasets-1.13.3-py3-none-any.whl (287 kB)\n","\u001b[K     |████████████████████████████████| 287 kB 53.5 MB/s \n","\u001b[?25h  Downloading datasets-1.13.2-py3-none-any.whl (287 kB)\n","\u001b[K     |████████████████████████████████| 287 kB 44.0 MB/s \n","\u001b[?25h  Downloading datasets-1.13.1-py3-none-any.whl (287 kB)\n","\u001b[K     |████████████████████████████████| 287 kB 46.2 MB/s \n","\u001b[?25h  Downloading datasets-1.13.0-py3-none-any.whl (285 kB)\n","\u001b[K     |████████████████████████████████| 285 kB 55.8 MB/s \n","\u001b[?25h  Downloading datasets-1.12.1-py3-none-any.whl (270 kB)\n","\u001b[K     |████████████████████████████████| 270 kB 52.3 MB/s \n","\u001b[?25h  Downloading datasets-1.12.0-py3-none-any.whl (269 kB)\n","\u001b[K     |████████████████████████████████| 269 kB 54.6 MB/s \n","\u001b[?25h  Downloading datasets-1.11.0-py3-none-any.whl (264 kB)\n","\u001b[K     |████████████████████████████████| 264 kB 55.0 MB/s \n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from datasets) (1.3.5)\n","Requirement already satisfied: dill in /usr/local/lib/python3.7/dist-packages (from datasets) (0.3.5.1)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.9.2) (2022.6.15)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.9.2) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.9.2) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.9.2) (2.10)\n","Requirement already satisfied: scikit-learn>=0.21.3 in /usr/local/lib/python3.7/dist-packages (from seqeval) (1.0.2)\n","Requirement already satisfied: scipy>=1.1.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn>=0.21.3->seqeval) (1.7.3)\n","Requirement already satisfied: joblib>=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn>=0.21.3->seqeval) (1.1.0)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn>=0.21.3->seqeval) (3.1.0)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers==4.9.2) (3.8.1)\n","Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2022.1)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil>=2.7.3->pandas->datasets) (1.15.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==4.9.2) (7.1.2)\n","Building wheels for collected packages: seqeval, sacremoses\n","  Building wheel for seqeval (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for seqeval: filename=seqeval-1.2.2-py3-none-any.whl size=16180 sha256=449cb2bb9a41aa92808c852637ab4a254bd57a26d8ad06fa5ae8281a8476da1f\n","  Stored in directory: /root/.cache/pip/wheels/05/96/ee/7cac4e74f3b19e3158dce26a20a1c86b3533c43ec72a549fd7\n","  Building wheel for sacremoses (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sacremoses: filename=sacremoses-0.0.53-py3-none-any.whl size=895260 sha256=d81660b76ef0251a785ad521ddc91d156cbc6d3f53fcc6fae334ef000cad188d\n","  Stored in directory: /root/.cache/pip/wheels/87/39/dd/a83eeef36d0bf98e7a4d1933a4ad2d660295a40613079bafc9\n","Successfully built seqeval sacremoses\n","Installing collected packages: xxhash, tokenizers, sacremoses, pyyaml, multiprocess, huggingface-hub, fsspec, transformers, seqeval, datasets\n","  Attempting uninstall: pyyaml\n","    Found existing installation: PyYAML 3.13\n","    Uninstalling PyYAML-3.13:\n","      Successfully uninstalled PyYAML-3.13\n","Successfully installed datasets-1.11.0 fsspec-2022.7.1 huggingface-hub-0.0.12 multiprocess-0.70.13 pyyaml-6.0 sacremoses-0.0.53 seqeval-1.2.2 tokenizers-0.10.3 transformers-4.9.2 xxhash-3.0.0\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting sentencepiece\n","  Downloading sentencepiece-0.1.96-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.2 MB)\n","\u001b[K     |████████████████████████████████| 1.2 MB 4.1 MB/s \n","\u001b[?25hInstalling collected packages: sentencepiece\n","Successfully installed sentencepiece-0.1.96\n"]}],"source":["!pip install datasets transformers==4.9.2 seqeval\n","!pip install sentencepiece"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"W-StNLF48P7B"},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import glob\n","import sys\n","import os\n","import re\n","\n","from transformers import (\n","    AutoModel, AutoTokenizer, AutoConfig,\n","    AutoModelForTokenClassification,\n","    TrainingArguments, Trainer,\n","    DataCollatorForTokenClassification\n",")\n","\n","from datasets import (\n","    load_dataset, load_metric,\n","    Dataset,\n","    DatasetDict,\n","    Features, Sequence, ClassLabel, Value\n",")\n","from sklearn.metrics import classification_report"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":217,"referenced_widgets":["43edb124218745c3bf51757880076c9d","d82ad499fa5441189e13e8dc88186753","e2f714c9b2394882a2f20dd8e11c02c1","02a076131968461ca8367320b96e99c9","bad6f9692def4a44b178fb8d264fc021","cdfef47918a941b7a31a9ea2b25c9736","112174a0c8e14d5a821eca6960d3602c","5cd86e0bed764d09aaff99cfcc0cce91","30be33ed7801465f8b74e3f68f56c26f","be20091b09344381a172eeb3b2b0b2c3","98568893bf7a4b8f85ee4543495a57f8","01af239475f74873829bae5f10b4b9a7","b3bdbbe32f6b4e6384d098f8eb50e7b8","e1d94934085841cba752ff49c1a6d6af","ec2dd81da1ac4a0888af2eca837aba78","e89f07f543a44b299ba14c58b2d74538","68a7dd2f395e44e39323aec88f3fef06","595c34c5bac64547b0bcb349a4f23333","869720b854444e15b6f5c845d113418b","d874d7deee924ad9bbe6cb3d5d7ec7cc","92c77603b35e43c8a7bfdfff5adcfec5","0130378cd8af4c17ae2552a5c90fcc9a","63bdb312cfa744febdbc17f94e05f9ad","6c6e6ce7c245401fb7456c5a2c9055a1","7a12939d03e94d31a5398f2ed10ef3c3","65d81ca833fb4d939d99283541722f24","a54cfa74945f4c5d92eb662f233dba40","6e6cfd26ddaf414094b7b5ea7b870e37","3e24257fd5414f63bc4a871c56860398","2d6db0e9b185445b8e9c9a0e5cc027d9","58b51372d81e4a74b3b91bfd7119a848","5b2af77ed3a14a23b851805e5850c581","d817bf02830d4405a6f3fd9620ddfe0b","be767d8f6ccf47d7885f680a690f5fc1","01d7df7cb2a04a17a943fc080e6ecc98","fcad6890ac764cb284c4b56cb1b66fd0","931297021e424a41b73c37c26baf3b01","303e9d474d0c48d0a88dc30c3032d15a","13179be58e254213924544a179665fde","76f2572f178a4303b287f1983993e91d","23b3c328424b4e43b88369e6889e501c","18e6ec7b5a364214bef0d16ddba2198b","bf83f7869bbc429e9d2d5071d6d97e40","a192e7baad1d4728bf9abc809fe0f8a4"]},"executionInfo":{"elapsed":40366,"status":"ok","timestamp":1659618287202,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"id":"zSp5KGBKJRQ0","outputId":"594143f9-d6fe-4511-e039-4089c579c157"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/546 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"43edb124218745c3bf51757880076c9d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/423M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"01af239475f74873829bae5f10b4b9a7"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at airesearch/wangchanberta-base-att-spm-uncased were not used when initializing CamembertModel: ['lm_head.layer_norm.bias', 'lm_head.dense.weight', 'lm_head.decoder.weight', 'lm_head.bias', 'lm_head.layer_norm.weight', 'lm_head.dense.bias', 'lm_head.decoder.bias']\n","- This IS expected if you are initializing CamembertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing CamembertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/282 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"63bdb312cfa744febdbc17f94e05f9ad"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/905k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"be767d8f6ccf47d7885f680a690f5fc1"}},"metadata":{}}],"source":["lm_name = 'airesearch/wangchanberta-base-att-spm-uncased'\n","model = AutoModel.from_pretrained(lm_name)\n","tokenizer = AutoTokenizer.from_pretrained(lm_name)"]},{"cell_type":"markdown","metadata":{"id":"whPRbBNbIrIl"},"source":["## Loading the dataset"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IreSlFmlIrIm"},"outputs":[],"source":["import datasets\n","from datasets import  load_dataset, load_metric\n","from datasets import Dataset, Features, Sequence, ClassLabel,Value "]},{"cell_type":"code","source":["def get_df_limittoken(filepath,num_token=limit_n_tokens):\n","    keyList = ['tokens','POS','NER', 'clause','sep']\n","    data = {key: [] for key in keyList}\n","    for filename in glob.glob(os.path.join(filepath, '*.txt')):\n","        with open(os.path.join(os.getcwd(), filename), 'r') as f:\n","        #print(filename)\n","            column1 = []\n","            column2 = []\n","            column3 = []\n","            column4 = []\n","            column5 = []\n","            count_token = 0\n","            is_sep=False\n","            for i,line in enumerate(f.readlines()):\n","                entry = line.rstrip('\\n').split('\\t')\n","                #print(entry)\n","                #print(i)\n","                if(len(entry)!=4):\n","                    #entry = [' ','space','space','space']\n","                    is_sep=True\n","                    continue\n","                if(count_token==num_token):\n","                    data[\"tokens\"].append(column1)\n","                    data[\"POS\"].append(column2)\n","                    data[\"NER\"].append(column3)\n","                    data[\"clause\"].append(column4)\n","                    data[\"sep\"].append(column5)\n","                    # print(\"***\")\n","                    # print(filename)\n","                    # print(column1)\n","                    # print(column5)\n","                    column1 = []\n","                    column2 = []\n","                    column3 = []\n","                    column4 = []\n","                    column5 = []\n","                    count_token = 0\n","                    #continue\n","                column1.append(str(entry[0]).replace('_',' '))\n","                #replace _ with space\n","                column2.append(entry[1])\n","                column3.append(entry[2])\n","                column4.append(entry[3])\n","                if(is_sep and len(column5)!=0):\n","                    #print(column5)\n","                    column5[-1]='SEP'\n","                    column5.append('N')\n","                    is_sep=False\n","                else:               \n","                    column5.append('N')\n","                count_token+=1\n","            data[\"tokens\"].append(column1)\n","            data[\"POS\"].append(column2)\n","            data[\"NER\"].append(column3)\n","            data[\"clause\"].append(column4)\n","            data[\"sep\"].append(column5)\n","    df=pd.DataFrame.from_dict(data)\n","    df['n_tokens'] =df.tokens.apply(len)\n","    return df"],"metadata":{"id":"SKjx5ehwnQUY"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_kVBTvqAolmI"},"outputs":[],"source":["train_df=get_df_limittoken('/content/drive/My Drive/LST_20/train/')\n","test_df=get_df_limittoken('/content/drive/My Drive/LST_20/test/')\n","dev_df=get_df_limittoken('/content/drive/My Drive/LST_20/dev/')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DyIjYeS5Nm0Y","executionInfo":{"status":"ok","timestamp":1659618486236,"user_tz":-420,"elapsed":7,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"}},"outputId":"a1f355c5-53d7-4c3d-9a8c-d59eb4d73dd9"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                 tokens  \\\n","0     [กกต., ตราด,  , จัด, พิธี, ลง, นาม, สัตยาบัน, ...   \n","1     [ครบ, วาระ, การ, ดำรง, ตำแหน่ง,  , เมื่อ, วันท...   \n","2     [ใน, กฎ,  , หรือ, ข้อ, ห้าม, ใน, การ, เลือกตั้...   \n","3     [วุฒิสภา, ผ่าน, พรบ., องค์กร, ส่วน, ปกครอง, ท้...   \n","4     [ , มี, ความ, สัมพันธ์, ใกล้ชิด,  , กับ, นักกา...   \n","...                                                 ...   \n","1615                 [ตัว,  , อิสระ,  , หลากหลาย, \", .]   \n","1616  [ขอ, รัฐ, เพิ่ม, เงิน, -, ทำ, ประกัน, ชีวิต, อ...   \n","1617  [คัดกรอง, และ, ให้, ความรู้, กับ, ประชาชน, ใน,...   \n","1618  [\", ปรัชญา, \", จะ, ขอ, คุย, กับ, \", เป้ย, \", อ...   \n","1619  [ , เดี๋ยว, รอ, ให้, ทุก, อย่าง, พร้อม, ก่อน, ...   \n","\n","                                                    POS  \\\n","0     [NN, NN, PU, VV, NN, VV, NN, NN, PS, FX, VV, P...   \n","1     [VV, NN, FX, VV, NN, PU, PS, NN, PU, NU, PU, N...   \n","2     [PS, NN, PU, CC, NN, VV, PS, FX, VV, VV, FX, V...   \n","3     [NN, VV, NN, NN, NN, VV, NN, NN, VV, NN, PU, V...   \n","4     [PU, VV, FX, VV, AV, PU, PS, NN, NN, NN, PU, C...   \n","...                                                 ...   \n","1615                       [NN, PU, VV, PU, VV, PU, PU]   \n","1616  [VV, NN, VV, NN, PU, VV, VV, NN, NN, PS, NN, P...   \n","1617  [VV, CC, VV, NN, PS, NN, PS, NN, NN, CC, VV, P...   \n","1618  [PU, NN, PU, AX, VV, VV, PS, PU, NN, PU, AJ, C...   \n","1619  [PU, AV, VV, CC, AJ, CL, VV, AV, CC, CC, NN, F...   \n","\n","                                                    NER  \\\n","0     [B_ORG, B_LOC, O, O, O, O, O, O, O, O, O, O, O...   \n","1     [O, O, O, O, O, O, O, B_DTM, I_DTM, I_DTM, I_D...   \n","2     [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...   \n","3     [B_ORG, O, O, B_ORG, I_ORG, I_ORG, E_ORG, O, O...   \n","4     [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...   \n","...                                                 ...   \n","1615                              [O, O, O, O, O, O, O]   \n","1616  [O, O, O, O, O, O, O, O, B_ORG, O, B_DTM, I_DT...   \n","1617  [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...   \n","1618  [O, B_PER, O, O, O, O, O, O, B_PER, O, O, O, O...   \n","1619  [O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...   \n","\n","                                                 clause  \\\n","0     [B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...   \n","1     [I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...   \n","2     [I_CLS, E_CLS, O, B_CLS, I_CLS, I_CLS, I_CLS, ...   \n","3     [B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, E_C...   \n","4     [I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...   \n","...                                                 ...   \n","1615  [I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, E_CLS]   \n","1616  [B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...   \n","1617  [E_CLS, B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...   \n","1618  [B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...   \n","1619  [I_CLS, I_CLS, E_CLS, B_CLS, I_CLS, I_CLS, I_C...   \n","\n","                                                    sep  n_tokens  \n","0     [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...       150  \n","1     [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...       150  \n","2     [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...        63  \n","3     [N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N...       150  \n","4     [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...        98  \n","...                                                 ...       ...  \n","1615                              [N, N, N, N, N, N, N]         7  \n","1616  [N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N...       150  \n","1617  [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...       105  \n","1618  [N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N...       150  \n","1619  [N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N...        98  \n","\n","[1620 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-b2783a4a-21ab-43be-9bf0-96164e1728c3\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>tokens</th>\n","      <th>POS</th>\n","      <th>NER</th>\n","      <th>clause</th>\n","      <th>sep</th>\n","      <th>n_tokens</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>[กกต., ตราด,  , จัด, พิธี, ลง, นาม, สัตยาบัน, ...</td>\n","      <td>[NN, NN, PU, VV, NN, VV, NN, NN, PS, FX, VV, P...</td>\n","      <td>[B_ORG, B_LOC, O, O, O, O, O, O, O, O, O, O, O...</td>\n","      <td>[B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...</td>\n","      <td>150</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>[ครบ, วาระ, การ, ดำรง, ตำแหน่ง,  , เมื่อ, วันท...</td>\n","      <td>[VV, NN, FX, VV, NN, PU, PS, NN, PU, NU, PU, N...</td>\n","      <td>[O, O, O, O, O, O, O, B_DTM, I_DTM, I_DTM, I_D...</td>\n","      <td>[I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...</td>\n","      <td>150</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>[ใน, กฎ,  , หรือ, ข้อ, ห้าม, ใน, การ, เลือกตั้...</td>\n","      <td>[PS, NN, PU, CC, NN, VV, PS, FX, VV, VV, FX, V...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[I_CLS, E_CLS, O, B_CLS, I_CLS, I_CLS, I_CLS, ...</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...</td>\n","      <td>63</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>[วุฒิสภา, ผ่าน, พรบ., องค์กร, ส่วน, ปกครอง, ท้...</td>\n","      <td>[NN, VV, NN, NN, NN, VV, NN, NN, VV, NN, PU, V...</td>\n","      <td>[B_ORG, O, O, B_ORG, I_ORG, I_ORG, E_ORG, O, O...</td>\n","      <td>[B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, E_C...</td>\n","      <td>[N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N...</td>\n","      <td>150</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[ , มี, ความ, สัมพันธ์, ใกล้ชิด,  , กับ, นักกา...</td>\n","      <td>[PU, VV, FX, VV, AV, PU, PS, NN, NN, NN, PU, C...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...</td>\n","      <td>98</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1615</th>\n","      <td>[ตัว,  , อิสระ,  , หลากหลาย, \", .]</td>\n","      <td>[NN, PU, VV, PU, VV, PU, PU]</td>\n","      <td>[O, O, O, O, O, O, O]</td>\n","      <td>[I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, E_CLS]</td>\n","      <td>[N, N, N, N, N, N, N]</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>1616</th>\n","      <td>[ขอ, รัฐ, เพิ่ม, เงิน, -, ทำ, ประกัน, ชีวิต, อ...</td>\n","      <td>[VV, NN, VV, NN, PU, VV, VV, NN, NN, PS, NN, P...</td>\n","      <td>[O, O, O, O, O, O, O, O, B_ORG, O, B_DTM, I_DT...</td>\n","      <td>[B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...</td>\n","      <td>[N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N...</td>\n","      <td>150</td>\n","    </tr>\n","    <tr>\n","      <th>1617</th>\n","      <td>[คัดกรอง, และ, ให้, ความรู้, กับ, ประชาชน, ใน,...</td>\n","      <td>[VV, CC, VV, NN, PS, NN, PS, NN, NN, CC, VV, P...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[E_CLS, B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...</td>\n","      <td>105</td>\n","    </tr>\n","    <tr>\n","      <th>1618</th>\n","      <td>[\", ปรัชญา, \", จะ, ขอ, คุย, กับ, \", เป้ย, \", อ...</td>\n","      <td>[PU, NN, PU, AX, VV, VV, PS, PU, NN, PU, AJ, C...</td>\n","      <td>[O, B_PER, O, O, O, O, O, O, B_PER, O, O, O, O...</td>\n","      <td>[B_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_CLS, I_C...</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N...</td>\n","      <td>150</td>\n","    </tr>\n","    <tr>\n","      <th>1619</th>\n","      <td>[ , เดี๋ยว, รอ, ให้, ทุก, อย่าง, พร้อม, ก่อน, ...</td>\n","      <td>[PU, AV, VV, CC, AJ, CL, VV, AV, CC, CC, NN, F...</td>\n","      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, ...</td>\n","      <td>[I_CLS, I_CLS, E_CLS, B_CLS, I_CLS, I_CLS, I_C...</td>\n","      <td>[N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N...</td>\n","      <td>98</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1620 rows × 6 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b2783a4a-21ab-43be-9bf0-96164e1728c3')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b2783a4a-21ab-43be-9bf0-96164e1728c3 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b2783a4a-21ab-43be-9bf0-96164e1728c3');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":10}],"source":["test_df"]},{"cell_type":"code","source":["test_df.n_tokens.max()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QPer1F4E66Bn","executionInfo":{"status":"ok","timestamp":1659618486962,"user_tz":-420,"elapsed":4,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"}},"outputId":"6c4e621c-fc03-49c3-994f-6795901e1271"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["150"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nTchl4Cmww5K"},"outputs":[],"source":["train = train_df[[\"tokens\",\"sep\"]].to_dict(orient=\"series\")\n","dev = dev_df[[\"tokens\",\"sep\"]].to_dict(orient=\"series\")\n","test = test_df[[\"tokens\",\"sep\"]].to_dict(orient=\"series\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fb0tTII-x5oY","executionInfo":{"status":"ok","timestamp":1659618486962,"user_tz":-420,"elapsed":3,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"}},"outputId":"2eb9284d-1be7-4678-dc05-83ad9606cc47"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'sep': 0       [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...\n"," 1       [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...\n"," 2       [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...\n"," 3       [N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N...\n"," 4       [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...\n","                               ...                        \n"," 1615                                [N, N, N, N, N, N, N]\n"," 1616    [N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N...\n"," 1617    [N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...\n"," 1618    [N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N...\n"," 1619    [N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N...\n"," Name: sep, Length: 1620, dtype: object,\n"," 'tokens': 0       [กกต., ตราด,  , จัด, พิธี, ลง, นาม, สัตยาบัน, ...\n"," 1       [ครบ, วาระ, การ, ดำรง, ตำแหน่ง,  , เมื่อ, วันท...\n"," 2       [ใน, กฎ,  , หรือ, ข้อ, ห้าม, ใน, การ, เลือกตั้...\n"," 3       [วุฒิสภา, ผ่าน, พรบ., องค์กร, ส่วน, ปกครอง, ท้...\n"," 4       [ , มี, ความ, สัมพันธ์, ใกล้ชิด,  , กับ, นักกา...\n","                               ...                        \n"," 1615                   [ตัว,  , อิสระ,  , หลากหลาย, \", .]\n"," 1616    [ขอ, รัฐ, เพิ่ม, เงิน, -, ทำ, ประกัน, ชีวิต, อ...\n"," 1617    [คัดกรอง, และ, ให้, ความรู้, กับ, ประชาชน, ใน,...\n"," 1618    [\", ปรัชญา, \", จะ, ขอ, คุย, กับ, \", เป้ย, \", อ...\n"," 1619    [ , เดี๋ยว, รอ, ให้, ทุก, อย่าง, พร้อม, ก่อน, ...\n"," Name: tokens, Length: 1620, dtype: object}"]},"metadata":{},"execution_count":13}],"source":["test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aGoymAZXM3oA"},"outputs":[],"source":["sep_features= Features(\n","                {\n","                    \"tokens\": Sequence(Value('string')),\n","                    \"sep\": Sequence(feature=ClassLabel(names=['N','SEP']))\n","                })"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kAqXek3ZDIQQ"},"outputs":[],"source":["data = DatasetDict({'train': Dataset.from_dict(train,features=sep_features), \n","                 'dev': Dataset.from_dict(dev,features=sep_features),\n","                 'test': Dataset.from_dict(test,features=sep_features)})"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BliNjdk-I2RB","executionInfo":{"status":"ok","timestamp":1659618499016,"user_tz":-420,"elapsed":14,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"}},"outputId":"e4d10d4d-2faf-4d1d-ee74-21850c35617c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'sep': Sequence(feature=ClassLabel(num_classes=2, names=['N', 'SEP'], names_file=None, id=None), length=-1, id=None),\n"," 'tokens': Sequence(feature=Value(dtype='string', id=None), length=-1, id=None)}"]},"metadata":{},"execution_count":16}],"source":["data['train'].features"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"i3j8APAoIrI3"},"outputs":[],"source":["from datasets import ClassLabel, Sequence\n","import random\n","import pandas as pd\n","from IPython.display import display, HTML\n","\n","def show_random_elements(dataset, num_examples=10):\n","    assert num_examples <= len(dataset), \"Can't pick more elements than there are in the dataset.\"\n","    picks = []\n","    for _ in range(num_examples):\n","        pick = random.randint(0, len(dataset)-1)\n","        while pick in picks:\n","            pick = random.randint(0, len(dataset)-1)\n","        picks.append(pick)\n","    \n","    df = pd.DataFrame(dataset[picks])\n","    for column, typ in dataset.features.items():\n","        if isinstance(typ, ClassLabel):\n","            df[column] = df[column].transform(lambda i: typ.names[i])\n","        elif isinstance(typ, Sequence) and isinstance(typ.feature, ClassLabel):\n","            df[column] = df[column].transform(lambda x: [typ.feature.names[i] for i in x])\n","    display(HTML(df.to_html()))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SZy5tRB_IrI7","scrolled":true,"executionInfo":{"status":"ok","timestamp":1659618499017,"user_tz":-420,"elapsed":13,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"}},"outputId":"c30ccb22-aa92-48b4-ca2a-2da0cba8a463"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>tokens</th>\n","      <th>sep</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>[%,  , เนื่องจาก, ระยะหลัง, ภาค, ธุรกิจ, ปลด, พนักงาน, มาก, ขึ้น,  , ทำให้, กำลัง, การ, ผลิต, ชะลอ, ตัว, ลง, ด้าน, ผล, การ, สำรวจ, โดย, บริษัท,  , เอดีพี,  , พบ, ว่า,  , ช่วง, เดือน, พ.ค., ภาค, ธุรกิจ, สหรัฐ, ปลด, พนักงาน, ถึง,  , 5.32,  , แสน, คน,  , น้อย, กว่า, เดือน, เม.ย.,  , ที่,  , 5.45,  , แสน, คน, แต่, ถือ, เป็น, ตัว, เลขที่, สูง, กว่า, ที่, นัก, วิเคราะห์, คาดการณ์, ไว้, ที่,  , 5.25,  , แสน, คน, อย่างไรก็ตาม,  , ฮวน,  , โซมาเบีย,  , ผู้, อำนวยการ, องค์การแรงงาน, ระหว่าง, ประเทศ,  , (, ไอแอลโอ, ),  , เปิดเผย, ว่า,  , วิกฤต, แรงงาน, โลก, อาจ, ยืดเยื้อ, นาน, ถึง, ...]</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>[ไล่, ที่, พล.2รอ.,  , ผม, ก็, เลย, เสนอ, ว่า, ถ้า, ขยับ, จาก, พล.2รอ., ควร, จะ, ต้อง, ดี, กว่า, นี้, \",  , พ.ต.ท., ทักษิณ, พ.ต.ท., ทักษิณ, ถึง, พล.อ., สพรั่ง,  , กัลยาณมิตร,  , ผช., ผบ., ทบ., ด้วย, ว่า, จำ, ได้, ว่า, โผ, ที่, เสนอ, มา, ขึ้น, มา, เป็น, พล, เอก, ประจำ, แต่, ก่อนหน้า, นี้, โผ, โยกย้าย, ครั้ง, ก่อน, ตน, เคย, เสนอ, ให้, เป็น, แม่ทัพ, ภาค, ที่,  , 4, ผม, ไม่, ได้, รู้จัก, กับ, พล.อ., สพรั่ง, เป็น, การ, ส่วน, ตัว, จะ, ว่า, ไป, ผม, ก็, ชื่นชม, เขา, ด้วย, ซ้ำ, ยัง, เคย, ให้, เขา, เป็น, แม่ทัพ, ภาค, ที่,  , 4,  , เลย, เพราะ, เห็น, ...]</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>[ฟีม, กลับ, มา, อยู่, ที่,  , 10,  , แต่, เมื่อ, ผ่าน, ไป,  , 2,  , รอบ, ฟีม, กลับ, รูด, ลง, ไป, ที่,  , 13,  , และ, รอบ, ต่อมา, ก็, ขยับ, ขึ้น, มา, ที่,  , 10,  , เท่า, ตำแหน่ง, อีก, จน, รอบ, ที่,  , 4,  , เจ้า, ฟีม, ก็, แซง, เพื่อน, ร่วม, ทีม, เฮกเตอร์,  , ฟาเบล, ขึ้น, มา, อยู่, ที่,  , 9,  , และ, ก็, รักษา, อันดับ, อยู่, จน, รอบ, ที่,  , 14,  , นัก, บิด, ไทย, ก็, ขยับ, ขึ้น, มา, ที่,  , 8, เมื่อ, ไมค์,  , ดิแม็กจิโอ, หลุด, โค้ง, ออก, ไป, และ, เมื่อ, ผ่าน, ไป,  , 15,  , รอบ, \", ...]</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>[ , โดย, ถ้า, เป็น, เมื่อ, หลาย, สัปดาห์, ก่อน,  , อาจ, เป็น, สิ่ง, ที่, หลาย, คน, ไม่, คาดคิด, ว่า, จะ, เกิด, ขึ้น, ได้, เมื่อ, วัน, ศุกร์,  , ผู้นำ, สูง, สุด, อิหร่าน, ออก, มา, สนับสนุน, ประธานาธิบดี, มาหมู๊ด,  , อมาดิเนจ๊าด, เต็มที่,  , โดย, ชื่นชม, การ, มา, ใช้, สิทธิ, ของ, ประชาชน, จำนวน, มาก, ว่า,  , แสดง, ถึง, ความ, เป็น, ประชาธิปไตย, ของ, ประเทศ,  , เพราะ, หาก, ประชาชน, รู้สึก, ว่า, ไม่, มี, อิสระ,  , ก็, คง, ไม่, ออก, มา, ใช้, สิทธิ, กัน, มากมาย,  , พร้อม, ยืนยัน, ว่า,  , อมาดิเนจ๊าด, เป็น, ผู้, ชนะ, การ, เลือกตั้ง,  , เพราะ, ได้, เสียง, มาก, กว่า, คู่, แข่ง,  , 11,  , ล้าน, ...]</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[ประชุม, เชิง, ปฏิบัติ, การ, ปลาย, เดือน,  , ก.ค., นี้, ส่วน, การ, เสนอ, ตั้ง, ธนาคาร, ที่ดิน, -, เก็บ, ภาษี, ที่ดิน, ที่, ไม่, ได้, ใช้, ประโยชน์,  , หลัง, พบ, การ, กระจุก, ตัว, ใน, การ, ถือ, ครอง, ที่ดิน, โดย, คน, บาง, กลุ่ม, ขณะ, ที่, เกษตรกร, ส่วนใหญ่, ไม่, มี, ที่, ทำกิน, เป็น, ของ, ตัวเอง,  , นายก, ฯ,  , มอบหมาย, ให้, กระทรวง, การ, คลัง,  , เป็น, อนุกรรมการ, ฯ,  , เดินหน้า, พร้อม, กับ, ระเบียบ, การ, จัดเก็บ, ภาษี, ที่ดิน,  , ให้, เป็น,  , \", กองทุน, ธนาคาร, ที่ดิน, \",  , เพื่อ, เป็น, การ, กระจาย, อำนาจ,  , และ, ให้, อนุกรรมการ, ฯ, ไป, ทำ, ระเบียบ, การ, จัดเก็บ, ภาษี, ที่ดิน, ก้าวหน้า, ...]</td>\n","      <td>[N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...]</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>[ชุมพล, เล็ง, ตั้ง, \", น้อง, นก, \", ทูต, กีฬา, \", น้อง, นก, \",  , นพวรรณ,  , เลิศชีวกานต์,  , แชมป์, จูเนียร์วิมเบิลดัน, ชาว, ไทย,  , กลับ, ถึง, เมืองไทย,  , สุด, ปลื้ม, คน, แห่, รอ, ต้อนรับ, ด้าน,  , \", รมต., กีฬา, \",  , เตรียม, ทำ, เรื่อง, ให้, เป็น,  , \", ทูต, กีฬา, \",  , และ, พา, เตรียม, เข้า, พบ, นายก, รัฐมนตรี,  , เช้า, วันที่,  , 9,  , ก.ค., ขณะ, ที่, บริษัท, เอเยนซี, ใน, เมือง, นอก, รุม, แย่ง, ตัว, ขอ, ดูแล, เรื่อง, สปอนเซอร์,  , ส่วน,  , จ., เชียงใหม่,  , เตรียม, งาน, ต้อนรับ, ยิ่งใหญ่,  , วันที่,  , 13,  , ก.ค., นี้, \", น้อง, นก, \", ...]</td>\n","      <td>[N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, ...]</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>[จะ, ต้อง, รับผิดชอบ, หรือไม่, ผม, ก็, ตอบ, ว่า, ต้อง, รับผิดชอบ, แล้ว, ก็, ยก, ตัวอย่าง, ว่า, ที่, เกาหลี, นั้น, เพียง, นายก, รัฐมนตรี, มัว, ไป, ตี, กอล์ฟ, ในระหว่าง, ที่, มี, เรื่อง, วุ่นวาย, นายก, รัฐมนตรี, ยัง, ต้อง, ลาออก, คำ, ตอบ, ดังกล่าว, อาจ, จะ, ถูกใจ, คน, บ้าง, ไม่, ถูกใจ, คน, บ้าง, แต่, ผม, ก็, ถือ, หลัก, ว่า, เมื่อ, ถาม, มา, ก็, ต้อง, ตอบ, ตรงไปตรงมา, ตาม, ความเห็น, ของ, ผม, เพราะ, ถ้า, ต้องการ, ทำ, คำ, ตอบ, เพื่อ, ให้, ถูกใจ, ก็, ไม่, จำเป็น, ต้อง, ถาม, มา, เพราะ, อยาก, ได้, คำ, ตอบ, ตาม, อารมณ์, อย่างไร, ก็, คิด, เอา, เอง, ได้, อยู่]</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N]</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>[ผู้, อพยพ, ลี้, ภัย, ความ, อดอยาก, และ, ความ, ยากจน, จาก, เกาหลีเหนือ, ไป, ยัง, จีน, จะ, เพิ่ม, มาก, ขึ้น, เนื่องจาก, สถานการณ์, ปัจจุบัน, เกาหลีเหนือ, ยังคง, ต้อง, พึ่งพา, ความ, ช่วยเหลือ, จาก, ต่างชาติ, บรรเทา, สภาวะ, อดอยาก, จาก, ปัญหา, ผล, ผลิต, ทาง, การ, เกษตร, ไม่, เพียงพอ, มา, โดย, ตลอด, ., -, สำนัก, ข่าว, ไทย, ทาง, ด้าน, หนังสือพิมพ์, เหวิน,  , เหว่ยเป้า, ของ, ฮ่องกง, ซึ่ง, โปร, รัฐบาล, จีน, รายงาน, ใน, วัน, นี้, ว่า, หลังจาก, เกาหลีเหนือ, ทำการ, ทดลอง, อาวุธ, นิวเคลียร์, ครั้ง, แรก, ของ, ประเทศ, เมื่อ, เช้า, วาน, นี้, กองทัพ, จีน, ได้, สั่ง, ยกเลิก, ใบ, ลา, ของ, ทหาร, ที่, ประจำการ, อยู่, ตาม, แนว, ชายแดน, ใน, มณฑล, จื้อหลิน, ซึ่ง, ร้อย, ...]</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...]</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>[กทช., แจง, ที่, ประชุม, สภา, ยัน, ไม่, ได้, ปิด, ดี, สเตชั่น, กรรมการ,  , กทช.,  , แจง, ที่, ประชุม, สภา,  , ยัน,  , ไม่, ได้, ปิด,  , ดี,  , สเตชั่น,  , เพราะ, ไม่, ได้, อยู่, ใน, ความ, รับผิดชอบ, นาย, เศรษฐพร,  , คูศรีพิทักษ์,  , กรรมการ, กิจการ, โทรคมนาคม, แห่ง, ชาติ,  , (, กทช., ),  , ตอบ, ข้อ, ซักถาม, ต่อ, สมาชิก, สภา, ผู้, แทน, ราษฎร, ใน, ที่, ประชุม,  , กรณี, การ, ปิด,  , สถานีโทรทัศน์,  , ดี,  , สเตชั่น,  , ว่า, สถานี, โทรทัศน์,  , ดี,  , สเตชั่น,  , ไม่, ได้, อยู่, ใน, ความ, รับผิดชอบ, ของ,  , กทช.,  , รวม, ทั้ง,  , กทช.,  , ไม่, เคย, ...]</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...]</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>[แพร่, เชื้อ, โรค, อย่าง, ร้ายแรง,  , ที่, ประชาชน, จะ, ต้อง, มา, เสียชีวิต, ไม่, รู้, เท่า, ไร,  , หาก, ซาก, สัตว์, ปีก, ที่, นำ, ไป, ทิ้ง, น้ำ, มี, เชื้อ, โรค, ไข้, หวัด, นก, กทม., ยัน, ไม่, พบ, ผู้, ป่วย, ไข้, หวัด, นก, ใน, กรุงเทพฯ, นาย, วัลลภ,  , สุวรรณดี,  , รอง, ผู้, ว่า, ฯ,  , กทม., กล่าว, ถึง, กรณีที่, พบ, ผู้, ป่วย, ต้องสงสัย, ไข้, หวัด, นก, ใน, พื้นที่,  , กทม.,  , ว่า, ยัง, ไม่, พบ, คน, ไข้, ที่, มี, เชื้อ, ไข้, หวัด, นก, ใน, กรุงเทพฯ,  , ทั้งสิ้น,  , โดย, ผู้, ป่วย, ที่, กระทรวง, สาธารณสุข, ระบุ, ว่า, พบ, ผู้, ป่วย, อยู่, ใน, ข่าย, ...]</td>\n","      <td>[N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, SEP, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, N, ...]</td>\n","    </tr>\n","  </tbody>\n","</table>"]},"metadata":{}}],"source":["show_random_elements(data['train'], num_examples=10)"]},{"cell_type":"markdown","metadata":{"id":"n9qywopnIrJH"},"source":["## Preprocessing the data"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Us7VZeI_MNUj"},"outputs":[],"source":["label_all_tokens = True\n","#True: all tokens have same label as original word\n","#False: only the first token have same label as original word"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vc0BSBLIIrJQ"},"outputs":[],"source":["def tokenize_and_align_labels(examples):\n","    tokenized_inputs = tokenizer(examples[\"tokens\"], truncation=True, is_split_into_words=True)\n","    tokens1 = [tokenizer.convert_ids_to_tokens(x) for x in tokenized_inputs[\"input_ids\"] ]\n","    tokens = [[token.replace( 'ํา',\"ำ\") for token in row] for row in tokens1]\n","    ids=[]\n","    labels = []\n","    for i, label in enumerate(examples[f\"{task}\"]):\n","        word_ids = tokenized_inputs.word_ids(batch_index=i)\n","        previous_word_idx = None\n","        label_ids = []\n","        for word_idx in word_ids:\n","            # Special tokens have a word id that is None. We set the label to -100 so they are automatically ignored in the loss function.\n","            if word_idx is None:\n","                label_ids.append(-100)\n","            # Set the label for the first token of each word.\n","            elif word_idx != previous_word_idx:\n","                label_ids.append(label[word_idx])\n","            # For the other tokens in a word, we set the label to either the current label or -100, depending on\n","            # the label_all_tokens flag.\n","            else:\n","                label_ids.append(label[word_idx] if label_all_tokens else -100)\n","            previous_word_idx = word_idx\n","\n","        labels.append(label_ids)\n","        ids.append(word_ids)\n","\n","    tokenized_inputs[\"labels\"] = labels\n","    tokenized_inputs[\"word_ids\"] = ids\n","    tokenized_inputs[\"tokens_bert\"] = tokens\n","    return tokenized_inputs\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":136,"referenced_widgets":["65fc46122f404d7fa7aa6e1904a626f0","61e2606be8f84e53be0506b4c04e6636","b9fb532312874d0e91aa2f188698f9e3","483c5802a12d4d129c026ae2ace2b9b7","9e9fc250b51040cc8bd1fc19d8ddbb9e","00ea0e7df54f4db1afcd190ea53e3093","e09e33ed9a0e4beaa609fbcba7fc1afb","164aa80e8b3b470dbc23956dbf53bc35","67fb7cde5bfd48bc82bd6558d69a9bbe","6b0ed085c5f1488389c239fd71697bff","0c4824e1cb0f4a7ab5cbcd9bc8605d8b","90064a7dfd474568bd93e74ae09c2873","1f06ff38caee4215a0485209091d5c8b","5e291da903e94bf0a141f38f49375573","dd3b7c9ab8634fc3b12c729cd7a71142","5909f5a5515047b6915c7715504fc360","c1da48a160d845d1982af2ba85c90d6e","e351c92cc9b7431c9c622de71134ec52","696504e7e8de414482030aaef731dbd6","f0838559a65c472798af8a18cb860c69","b1225ecc115e47f79d0b975009a6661c","38b280199c15494880f580727e4f61d1"]},"executionInfo":{"elapsed":996371,"status":"ok","timestamp":1659619495376,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"id":"fRM6NFMO82XL","outputId":"f14c95ef-fa34-4b97-d0d5-59414428f2ca"},"outputs":[{"output_type":"stream","name":"stderr","text":["Parameter 'function'=<function tokenize_and_align_labels at 0x7fde677404d0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/20 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"65fc46122f404d7fa7aa6e1904a626f0"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2 [00:00<?, ?ba/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"90064a7dfd474568bd93e74ae09c2873"}},"metadata":{}}],"source":["tokenized_datasets = data.map(tokenize_and_align_labels, batched=True)"]},{"cell_type":"code","source":["tokenized_datasets['train'][11]['labels']"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bABAAfoPY6ig","executionInfo":{"status":"ok","timestamp":1659619495376,"user_tz":-420,"elapsed":5,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"}},"outputId":"4d99c484-b97d-4bd6-b278-f76a00355805"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[-100,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 1,\n"," 1,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 1,\n"," 1,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," 0,\n"," -100]"]},"metadata":{},"execution_count":22}]},{"cell_type":"markdown","metadata":{"id":"545PP3o8IrJV"},"source":["## Fine-tuning the model"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nZf4a6Or5hwV"},"outputs":[],"source":["label_list = data['train'].features[f\"{task}\"].feature.names"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1659619495377,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"id":"2hWcOkebnU6I","outputId":"fc08e9c8-5cc5-41e0-8d54-2c2bdc803ff0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["['N', 'SEP']"]},"metadata":{},"execution_count":24}],"source":["label_list "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":156,"referenced_widgets":["2d194171147245f49bf766e3073de36d","54eccc043032445c81a3455ee9cbd1ba","616d1b1152b347b4a2c86e0e203f36ec","514ed1afc3a944ecb54d0c4cc7c8039a","8a0cd192f5994be886ff783487071e2f","a12095c175254405aeda1cd6f9d957f4","1ccf8f61fd364b3ca99652c5eccac4f3","73f9c7814ff44b19ba3d0be8b5d07a67","9fdd7fa63d0f4b329dc684934ab5d05a","3302e8986be44f0aba9cce9a642e22a5","3938b2f8a98e4c009eee8010d3d32ee4"]},"executionInfo":{"elapsed":4325,"status":"ok","timestamp":1659619499699,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"id":"TlqNaB8jIrJW","outputId":"9be58cab-2de0-4668-de70-23f170ae141f"},"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at airesearch/wangchanberta-base-att-spm-uncased were not used when initializing CamembertForTokenClassification: ['lm_head.layer_norm.bias', 'lm_head.dense.weight', 'lm_head.decoder.weight', 'lm_head.bias', 'lm_head.layer_norm.weight', 'lm_head.decoder.bias', 'lm_head.dense.bias']\n","- This IS expected if you are initializing CamembertForTokenClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing CamembertForTokenClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of CamembertForTokenClassification were not initialized from the model checkpoint at airesearch/wangchanberta-base-att-spm-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/2.48k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2d194171147245f49bf766e3073de36d"}},"metadata":{}}],"source":["model = AutoModelForTokenClassification.from_pretrained(lm_name, num_labels=len(label_list))\n","model_name = model_checkpoint.split(\"/\")[-1]\n","\n","args = TrainingArguments(\n","    f\"/content/drive/My Drive/discon model/'{model_name}-{num_epoch} epoch-{condition}\",\n","    evaluation_strategy = \"epoch\",\n","    learning_rate=2e-5,\n","    per_device_train_batch_size=batch_size,\n","    per_device_eval_batch_size=batch_size,\n","    num_train_epochs=num_epoch,\n","    save_strategy=save,\n","    #save_total_limit = 2, \n","    #load_best_model_at_end=True,\n","    weight_decay=0.01,\n","    push_to_hub=False,\n",")\n","data_collator = DataCollatorForTokenClassification(tokenizer)\n","metric = load_metric(\"seqeval\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UmvbnJ9JIrJd"},"outputs":[],"source":["def compute_metrics(p):\n","    predictions, labels = p\n","    predictions = np.argmax(predictions, axis=2)\n","\n","    # Remove ignored index (special tokens)\n","    true_predictions = [\n","        [label_list[p] for (p, l) in zip(prediction, label) if l != -100]\n","        for prediction, label in zip(predictions, labels)\n","    ]\n","    true_labels = [\n","        [label_list[l] for (p, l) in zip(prediction, label) if l != -100]\n","        for prediction, label in zip(predictions, labels)\n","    ]\n","\n","    results = metric.compute(predictions=true_predictions, references=true_labels)\n","    return {\n","        \"precision\": results[\"overall_precision\"],\n","        \"recall\": results[\"overall_recall\"],\n","        \"f1\": results[\"overall_f1\"],\n","        \"accuracy\": results[\"overall_accuracy\"],\n","    }"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"imY1oC3SIrJf"},"outputs":[],"source":["trainer = Trainer(\n","    model,\n","    args,\n","    #for pre-tokenized dataset\n","    train_dataset=tokenized_datasets['train'],\n","    eval_dataset=tokenized_datasets['dev'],\n","    #for auto tokenized dataset\n","    # train_dataset=tokenized_string_datasets['train'],\n","    # eval_dataset=tokenized_string_datasets['dev'],    \n","    data_collator=data_collator,\n","    tokenizer=tokenizer,\n","    compute_metrics=compute_metrics\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":621},"executionInfo":{"elapsed":1797847,"status":"ok","timestamp":1659621304932,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"id":"3tlotgBzMNUm","outputId":"52a5b892-f9e1-4fba-a307-9516c55b49de"},"outputs":[{"output_type":"stream","name":"stderr","text":["The following columns in the training set  don't have a corresponding argument in `CamembertForTokenClassification.forward` and have been ignored: word_ids, sep, tokens_bert, tokens.\n","***** Running training *****\n","  Num examples = 19983\n","  Num Epochs = 3\n","  Instantaneous batch size per device = 16\n","  Total train batch size (w. parallel, distributed & accumulation) = 16\n","  Gradient Accumulation steps = 1\n","  Total optimization steps = 3747\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='3747' max='3747' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [3747/3747 29:53, Epoch 3/3]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>1</td>\n","      <td>0.030400</td>\n","      <td>No log</td>\n","    </tr>\n","    <tr>\n","      <td>2</td>\n","      <td>0.023000</td>\n","      <td>No log</td>\n","    </tr>\n","    <tr>\n","      <td>3</td>\n","      <td>0.019500</td>\n","      <td>No log</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["The following columns in the evaluation set  don't have a corresponding argument in `CamembertForTokenClassification.forward` and have been ignored: sep, tokens.\n","***** Running Evaluation *****\n","  Num examples = 0\n","  Batch size = 16\n","The following columns in the evaluation set  don't have a corresponding argument in `CamembertForTokenClassification.forward` and have been ignored: sep, tokens.\n","***** Running Evaluation *****\n","  Num examples = 0\n","  Batch size = 16\n","The following columns in the evaluation set  don't have a corresponding argument in `CamembertForTokenClassification.forward` and have been ignored: sep, tokens.\n","***** Running Evaluation *****\n","  Num examples = 0\n","  Batch size = 16\n","\n","\n","Training completed. Do not forget to share your model on huggingface.co/models =)\n","\n","\n"]},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=3747, training_loss=0.027536017817753552, metrics={'train_runtime': 1797.7804, 'train_samples_per_second': 33.346, 'train_steps_per_second': 2.084, 'total_flos': 8893631143406688.0, 'train_loss': 0.027536017817753552, 'epoch': 3.0})"]},"metadata":{},"execution_count":28}],"source":["trainer.train()"]},{"cell_type":"markdown","metadata":{"id":"BJ7B19X7NmJz"},"source":["##Evaluation for gold standard Pretokenized Dataset"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":27193,"status":"ok","timestamp":1659621332120,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"id":"EBHPSHBcNmJz","colab":{"base_uri":"https://localhost:8080/","height":176},"outputId":"774085f4-e5b9-4104-faf9-0f7f7d904abc"},"outputs":[{"output_type":"stream","name":"stderr","text":["The following columns in the test set  don't have a corresponding argument in `CamembertForTokenClassification.forward` and have been ignored: word_ids, sep, tokens_bert, tokens.\n","***** Running Prediction *****\n","  Num examples = 1620\n","  Batch size = 16\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='102' max='102' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [102/102 00:15]\n","    </div>\n","    "]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: N seems not to be NE tag.\n","  warnings.warn('{} seems not to be NE tag.'.format(chunk))\n","/usr/local/lib/python3.7/dist-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: SEP seems not to be NE tag.\n","  warnings.warn('{} seems not to be NE tag.'.format(chunk))\n"]}],"source":["predictions, labels, _ = trainer.predict(tokenized_datasets['test'])\n","predictions = np.argmax(predictions, axis=2)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gKmKl116oKXP"},"outputs":[],"source":["bert_prediction = [\n","    [(id, token, prediction) for (id, token, prediction) in zip(row_id, row_token,row_predictions) ]\n","    for row_id, row_token, row_predictions in zip(tokenized_datasets['test']['word_ids'],tokenized_datasets['test']['tokens_bert'],predictions)\n","]\n","\n","gold_label = [\n","    [label for label in row_label ]\n","    for row_label in tokenized_datasets['test'][task]\n","]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"klZJljKW1-VU"},"outputs":[],"source":["wrap_predict = [] \n","for row in bert_prediction:\n","    predict_row=[]\n","    previous_word=None\n","    for item in row:\n","        if(item[0] is not None):\n","            if(item[0] !=previous_word):\n","                predict_row.append(item[-1])\n","                previous_word = item[0]\n","    wrap_predict.append(predict_row)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"njQ9sMMbpzxs"},"outputs":[],"source":["sep_list=[\"N\",\"SEP\"]\n","def flatten(t):\n","    return [sep_list[item] for sublist in t for item in sublist]\n","flat_true_predictions = flatten(wrap_predict)\n","flat_true_labels = flatten(gold_label)"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":2632,"status":"ok","timestamp":1659621335435,"user":{"displayName":"Apiwat Jaroonpol","userId":"17107765437651157828"},"user_tz":-420},"id":"KuU_16eIiLYi","colab":{"base_uri":"https://localhost:8080/","height":206},"outputId":"35865eee-be40-402e-a03f-4fdfabf9aa33"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["              precision    recall  f1-score        support\n","N              0.997186  0.997521  0.997354  202511.000000\n","SEP            0.893169  0.880428  0.886753    4767.000000\n","accuracy       0.994828  0.994828  0.994828       0.994828\n","macro avg      0.945178  0.938975  0.942053  207278.000000\n","weighted avg   0.994794  0.994828  0.994810  207278.000000"],"text/html":["\n","  <div id=\"df-bab8e0bd-dc35-48f5-97fc-f884830071c3\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>precision</th>\n","      <th>recall</th>\n","      <th>f1-score</th>\n","      <th>support</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>N</th>\n","      <td>0.997186</td>\n","      <td>0.997521</td>\n","      <td>0.997354</td>\n","      <td>202511.000000</td>\n","    </tr>\n","    <tr>\n","      <th>SEP</th>\n","      <td>0.893169</td>\n","      <td>0.880428</td>\n","      <td>0.886753</td>\n","      <td>4767.000000</td>\n","    </tr>\n","    <tr>\n","      <th>accuracy</th>\n","      <td>0.994828</td>\n","      <td>0.994828</td>\n","      <td>0.994828</td>\n","      <td>0.994828</td>\n","    </tr>\n","    <tr>\n","      <th>macro avg</th>\n","      <td>0.945178</td>\n","      <td>0.938975</td>\n","      <td>0.942053</td>\n","      <td>207278.000000</td>\n","    </tr>\n","    <tr>\n","      <th>weighted avg</th>\n","      <td>0.994794</td>\n","      <td>0.994828</td>\n","      <td>0.994810</td>\n","      <td>207278.000000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-bab8e0bd-dc35-48f5-97fc-f884830071c3')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-bab8e0bd-dc35-48f5-97fc-f884830071c3 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-bab8e0bd-dc35-48f5-97fc-f884830071c3');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":33}],"source":["result = classification_report(flat_true_labels,flat_true_predictions,output_dict=True,labels=sep_list)\n","result_df=pd.DataFrame(result).transpose()\n","result_df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mx5x88Ah7K9R"},"outputs":[],"source":["result_df.to_csv(f\"/content/drive/My Drive/discon model/'{model_name}-{num_epoch} epoch-{condition}/{num_epoch} epoch-{condition}-nospace.csv\")"]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":["0VGGHrjXrQMh","whPRbBNbIrIl","n9qywopnIrJH"],"name":"Sentence Segment","provenance":[{"file_id":"1NELsE-6CyrOTZUfBRsl2ZbHuBTze1q8N","timestamp":1658740806424},{"file_id":"1XDdFD0l1L5UakgRw8SVxB-FPOit6qYU-","timestamp":1637638047242},{"file_id":"1Z9YjM7bzvzPuNQ4C11cFcD46hg6K4eGi","timestamp":1636450823506},{"file_id":"https://github.com/huggingface/notebooks/blob/master/examples/token_classification.ipynb","timestamp":1636352321184}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"43edb124218745c3bf51757880076c9d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d82ad499fa5441189e13e8dc88186753","IPY_MODEL_e2f714c9b2394882a2f20dd8e11c02c1","IPY_MODEL_02a076131968461ca8367320b96e99c9"],"layout":"IPY_MODEL_bad6f9692def4a44b178fb8d264fc021"}},"d82ad499fa5441189e13e8dc88186753":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cdfef47918a941b7a31a9ea2b25c9736","placeholder":"​","style":"IPY_MODEL_112174a0c8e14d5a821eca6960d3602c","value":"Downloading: 100%"}},"e2f714c9b2394882a2f20dd8e11c02c1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_5cd86e0bed764d09aaff99cfcc0cce91","max":546,"min":0,"orientation":"horizontal","style":"IPY_MODEL_30be33ed7801465f8b74e3f68f56c26f","value":546}},"02a076131968461ca8367320b96e99c9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_be20091b09344381a172eeb3b2b0b2c3","placeholder":"​","style":"IPY_MODEL_98568893bf7a4b8f85ee4543495a57f8","value":" 546/546 [00:00&lt;00:00, 13.4kB/s]"}},"bad6f9692def4a44b178fb8d264fc021":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cdfef47918a941b7a31a9ea2b25c9736":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"112174a0c8e14d5a821eca6960d3602c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5cd86e0bed764d09aaff99cfcc0cce91":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"30be33ed7801465f8b74e3f68f56c26f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"be20091b09344381a172eeb3b2b0b2c3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"98568893bf7a4b8f85ee4543495a57f8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"01af239475f74873829bae5f10b4b9a7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b3bdbbe32f6b4e6384d098f8eb50e7b8","IPY_MODEL_e1d94934085841cba752ff49c1a6d6af","IPY_MODEL_ec2dd81da1ac4a0888af2eca837aba78"],"layout":"IPY_MODEL_e89f07f543a44b299ba14c58b2d74538"}},"b3bdbbe32f6b4e6384d098f8eb50e7b8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_68a7dd2f395e44e39323aec88f3fef06","placeholder":"​","style":"IPY_MODEL_595c34c5bac64547b0bcb349a4f23333","value":"Downloading: 100%"}},"e1d94934085841cba752ff49c1a6d6af":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_869720b854444e15b6f5c845d113418b","max":423498558,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d874d7deee924ad9bbe6cb3d5d7ec7cc","value":423498558}},"ec2dd81da1ac4a0888af2eca837aba78":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_92c77603b35e43c8a7bfdfff5adcfec5","placeholder":"​","style":"IPY_MODEL_0130378cd8af4c17ae2552a5c90fcc9a","value":" 423M/423M [00:24&lt;00:00, 18.9MB/s]"}},"e89f07f543a44b299ba14c58b2d74538":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"68a7dd2f395e44e39323aec88f3fef06":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"595c34c5bac64547b0bcb349a4f23333":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"869720b854444e15b6f5c845d113418b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d874d7deee924ad9bbe6cb3d5d7ec7cc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"92c77603b35e43c8a7bfdfff5adcfec5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0130378cd8af4c17ae2552a5c90fcc9a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"63bdb312cfa744febdbc17f94e05f9ad":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6c6e6ce7c245401fb7456c5a2c9055a1","IPY_MODEL_7a12939d03e94d31a5398f2ed10ef3c3","IPY_MODEL_65d81ca833fb4d939d99283541722f24"],"layout":"IPY_MODEL_a54cfa74945f4c5d92eb662f233dba40"}},"6c6e6ce7c245401fb7456c5a2c9055a1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6e6cfd26ddaf414094b7b5ea7b870e37","placeholder":"​","style":"IPY_MODEL_3e24257fd5414f63bc4a871c56860398","value":"Downloading: 100%"}},"7a12939d03e94d31a5398f2ed10ef3c3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2d6db0e9b185445b8e9c9a0e5cc027d9","max":282,"min":0,"orientation":"horizontal","style":"IPY_MODEL_58b51372d81e4a74b3b91bfd7119a848","value":282}},"65d81ca833fb4d939d99283541722f24":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5b2af77ed3a14a23b851805e5850c581","placeholder":"​","style":"IPY_MODEL_d817bf02830d4405a6f3fd9620ddfe0b","value":" 282/282 [00:00&lt;00:00, 2.46kB/s]"}},"a54cfa74945f4c5d92eb662f233dba40":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6e6cfd26ddaf414094b7b5ea7b870e37":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3e24257fd5414f63bc4a871c56860398":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2d6db0e9b185445b8e9c9a0e5cc027d9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"58b51372d81e4a74b3b91bfd7119a848":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5b2af77ed3a14a23b851805e5850c581":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d817bf02830d4405a6f3fd9620ddfe0b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"be767d8f6ccf47d7885f680a690f5fc1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_01d7df7cb2a04a17a943fc080e6ecc98","IPY_MODEL_fcad6890ac764cb284c4b56cb1b66fd0","IPY_MODEL_931297021e424a41b73c37c26baf3b01"],"layout":"IPY_MODEL_303e9d474d0c48d0a88dc30c3032d15a"}},"01d7df7cb2a04a17a943fc080e6ecc98":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_13179be58e254213924544a179665fde","placeholder":"​","style":"IPY_MODEL_76f2572f178a4303b287f1983993e91d","value":"Downloading: 100%"}},"fcad6890ac764cb284c4b56cb1b66fd0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_23b3c328424b4e43b88369e6889e501c","max":904693,"min":0,"orientation":"horizontal","style":"IPY_MODEL_18e6ec7b5a364214bef0d16ddba2198b","value":904693}},"931297021e424a41b73c37c26baf3b01":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bf83f7869bbc429e9d2d5071d6d97e40","placeholder":"​","style":"IPY_MODEL_a192e7baad1d4728bf9abc809fe0f8a4","value":" 905k/905k [00:01&lt;00:00, 1.10MB/s]"}},"303e9d474d0c48d0a88dc30c3032d15a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"13179be58e254213924544a179665fde":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"76f2572f178a4303b287f1983993e91d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"23b3c328424b4e43b88369e6889e501c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18e6ec7b5a364214bef0d16ddba2198b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bf83f7869bbc429e9d2d5071d6d97e40":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a192e7baad1d4728bf9abc809fe0f8a4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"65fc46122f404d7fa7aa6e1904a626f0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_61e2606be8f84e53be0506b4c04e6636","IPY_MODEL_b9fb532312874d0e91aa2f188698f9e3","IPY_MODEL_483c5802a12d4d129c026ae2ace2b9b7"],"layout":"IPY_MODEL_9e9fc250b51040cc8bd1fc19d8ddbb9e"}},"61e2606be8f84e53be0506b4c04e6636":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_00ea0e7df54f4db1afcd190ea53e3093","placeholder":"​","style":"IPY_MODEL_e09e33ed9a0e4beaa609fbcba7fc1afb","value":"100%"}},"b9fb532312874d0e91aa2f188698f9e3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_164aa80e8b3b470dbc23956dbf53bc35","max":20,"min":0,"orientation":"horizontal","style":"IPY_MODEL_67fb7cde5bfd48bc82bd6558d69a9bbe","value":20}},"483c5802a12d4d129c026ae2ace2b9b7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6b0ed085c5f1488389c239fd71697bff","placeholder":"​","style":"IPY_MODEL_0c4824e1cb0f4a7ab5cbcd9bc8605d8b","value":" 20/20 [15:25&lt;00:00, 46.54s/ba]"}},"9e9fc250b51040cc8bd1fc19d8ddbb9e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"00ea0e7df54f4db1afcd190ea53e3093":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e09e33ed9a0e4beaa609fbcba7fc1afb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"164aa80e8b3b470dbc23956dbf53bc35":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"67fb7cde5bfd48bc82bd6558d69a9bbe":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6b0ed085c5f1488389c239fd71697bff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0c4824e1cb0f4a7ab5cbcd9bc8605d8b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"90064a7dfd474568bd93e74ae09c2873":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1f06ff38caee4215a0485209091d5c8b","IPY_MODEL_5e291da903e94bf0a141f38f49375573","IPY_MODEL_dd3b7c9ab8634fc3b12c729cd7a71142"],"layout":"IPY_MODEL_5909f5a5515047b6915c7715504fc360"}},"1f06ff38caee4215a0485209091d5c8b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c1da48a160d845d1982af2ba85c90d6e","placeholder":"​","style":"IPY_MODEL_e351c92cc9b7431c9c622de71134ec52","value":"100%"}},"5e291da903e94bf0a141f38f49375573":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_696504e7e8de414482030aaef731dbd6","max":2,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f0838559a65c472798af8a18cb860c69","value":2}},"dd3b7c9ab8634fc3b12c729cd7a71142":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b1225ecc115e47f79d0b975009a6661c","placeholder":"​","style":"IPY_MODEL_38b280199c15494880f580727e4f61d1","value":" 2/2 [01:10&lt;00:00, 33.74s/ba]"}},"5909f5a5515047b6915c7715504fc360":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c1da48a160d845d1982af2ba85c90d6e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e351c92cc9b7431c9c622de71134ec52":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"696504e7e8de414482030aaef731dbd6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f0838559a65c472798af8a18cb860c69":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b1225ecc115e47f79d0b975009a6661c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"38b280199c15494880f580727e4f61d1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2d194171147245f49bf766e3073de36d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_54eccc043032445c81a3455ee9cbd1ba","IPY_MODEL_616d1b1152b347b4a2c86e0e203f36ec","IPY_MODEL_514ed1afc3a944ecb54d0c4cc7c8039a"],"layout":"IPY_MODEL_8a0cd192f5994be886ff783487071e2f"}},"54eccc043032445c81a3455ee9cbd1ba":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a12095c175254405aeda1cd6f9d957f4","placeholder":"​","style":"IPY_MODEL_1ccf8f61fd364b3ca99652c5eccac4f3","value":"Downloading: "}},"616d1b1152b347b4a2c86e0e203f36ec":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_73f9c7814ff44b19ba3d0be8b5d07a67","max":2482,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9fdd7fa63d0f4b329dc684934ab5d05a","value":2482}},"514ed1afc3a944ecb54d0c4cc7c8039a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3302e8986be44f0aba9cce9a642e22a5","placeholder":"​","style":"IPY_MODEL_3938b2f8a98e4c009eee8010d3d32ee4","value":" 6.34k/? [00:00&lt;00:00, 135kB/s]"}},"8a0cd192f5994be886ff783487071e2f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a12095c175254405aeda1cd6f9d957f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1ccf8f61fd364b3ca99652c5eccac4f3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"73f9c7814ff44b19ba3d0be8b5d07a67":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9fdd7fa63d0f4b329dc684934ab5d05a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3302e8986be44f0aba9cce9a642e22a5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3938b2f8a98e4c009eee8010d3d32ee4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}